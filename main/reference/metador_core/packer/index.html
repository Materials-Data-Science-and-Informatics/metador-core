
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Core of Metador, the metadata-first research data management framework.">
      
      
      
        <link rel="canonical" href="https://materials-data-science-and-informatics.github.io/metador-core/main/reference/metador_core/packer/">
      
      
        <link rel="prev" href="../ih5/skeleton/">
      
      
        <link rel="next" href="example/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.0, mkdocs-material-9.1.20">
    
    
      
        <title>packer - metador-core</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.eebd395e.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_markdown_exec_ansi.css">
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/style.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#metador_core.packer" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  This page is for an outdated or development version.
  <a href="../../../..">
    <strong>Click here to go to the latest stable version.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="metador-core" class="md-header__button md-logo" aria-label="metador-core" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            metador-core
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              packer
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Materials-Data-Science-and-Informatics/metador-core" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Materials-Data-Science-and-Informatics/metador-core
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        Home
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../quickstart/" class="md-tabs__link md-tabs__link--active">
        Usage
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../contributing/" class="md-tabs__link">
        Development
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="metador-core" class="md-nav__button md-logo" aria-label="metador-core" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    metador-core
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Materials-Data-Science-and-Informatics/metador-core" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Materials-Data-Science-and-Informatics/metador-core
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
      
      
      
        <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
          Home
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../changelog/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../credits/" class="md-nav__link">
        Credits
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../license/" class="md-nav__link">
        License
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Usage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Usage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../quickstart/" class="md-nav__link">
        Quickstart
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
          Notebooks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Notebooks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../notebooks/about/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../notebooks/01_MetadorContainer/" class="md-nav__link">
        Creating a MetadorContainer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../notebooks/02_YourFirstMetadorPlugin/" class="md-nav__link">
        Writing Metador Plugins
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../notebooks/03_Schemas/" class="md-nav__link">
        Designing Metadata Schemas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../notebooks/03b_SemanticsInteroperability/" class="md-nav__link">
        Semantics and Interoperability
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_1" checked>
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../">metador_core</a>
          
            <label for="__nav_2_3_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2_3_1">
          <span class="md-nav__icon md-icon"></span>
          metador_core
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_1_1" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../container/">container</a>
          
            <label for="__nav_2_3_1_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_1_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3_1_1">
          <span class="md-nav__icon md-icon"></span>
          container
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../container/drivers/" class="md-nav__link">
        drivers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../container/interface/" class="md-nav__link">
        interface
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../container/protocols/" class="md-nav__link">
        protocols
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../container/provider/" class="md-nav__link">
        provider
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../container/utils/" class="md-nav__link">
        utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../container/wrappers/" class="md-nav__link">
        wrappers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_1_2" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../harvester/">harvester</a>
          
            <label for="__nav_2_3_1_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_1_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3_1_2">
          <span class="md-nav__icon md-icon"></span>
          harvester
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../harvester/common/" class="md-nav__link">
        common
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_1_3" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../ih5/">ih5</a>
          
            <label for="__nav_2_3_1_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_1_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3_1_3">
          <span class="md-nav__icon md-icon"></span>
          ih5
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ih5/container/" class="md-nav__link">
        container
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ih5/manifest/" class="md-nav__link">
        manifest
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ih5/overlay/" class="md-nav__link">
        overlay
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ih5/record/" class="md-nav__link">
        record
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ih5/skeleton/" class="md-nav__link">
        skeleton
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_1_4" checked>
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index md-nav__link--active">
          <a href="./">packer</a>
          
            <label for="__nav_2_3_1_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_1_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2_3_1_4">
          <span class="md-nav__icon md-icon"></span>
          packer
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="example/" class="md-nav__link">
        example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="types/" class="md-nav__link">
        types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="utils/" class="md-nav__link">
        utils
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_1_5" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../plugin/">plugin</a>
          
            <label for="__nav_2_3_1_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_1_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3_1_5">
          <span class="md-nav__icon md-icon"></span>
          plugin
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plugin/entrypoints/" class="md-nav__link">
        entrypoints
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plugin/interface/" class="md-nav__link">
        interface
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plugin/metaclass/" class="md-nav__link">
        metaclass
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plugin/types/" class="md-nav__link">
        types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plugin/util/" class="md-nav__link">
        util
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/" class="md-nav__link">
        plugins
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_1_7" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../rdf/">rdf</a>
          
            <label for="__nav_2_3_1_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_1_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3_1_7">
          <span class="md-nav__icon md-icon"></span>
          rdf
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rdf/lib/" class="md-nav__link">
        lib
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rdf/skos/" class="md-nav__link">
        skos
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_1_8" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../schema/">schema</a>
          
            <label for="__nav_2_3_1_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_1_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3_1_8">
          <span class="md-nav__icon md-icon"></span>
          schema
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../schema/base/" class="md-nav__link">
        base
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_1_8_2" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../schema/common/">common</a>
          
            <label for="__nav_2_3_1_8_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_3_1_8_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3_1_8_2">
          <span class="md-nav__icon md-icon"></span>
          common
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../schema/common/rocrate/" class="md-nav__link">
        rocrate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../schema/common/schemaorg/" class="md-nav__link">
        schemaorg
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../schema/core/" class="md-nav__link">
        core
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../schema/decorators/" class="md-nav__link">
        decorators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../schema/encoder/" class="md-nav__link">
        encoder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../schema/inspect/" class="md-nav__link">
        inspect
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../schema/jsonschema/" class="md-nav__link">
        jsonschema
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../schema/ld/" class="md-nav__link">
        ld
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../schema/parser/" class="md-nav__link">
        parser
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../schema/partial/" class="md-nav__link">
        partial
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../schema/pg/" class="md-nav__link">
        pg
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../schema/plugins/" class="md-nav__link">
        plugins
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../schema/types/" class="md-nav__link">
        types
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_1_9" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../util/">util</a>
          
            <label for="__nav_2_3_1_9">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_1_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3_1_9">
          <span class="md-nav__icon md-icon"></span>
          util
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/diff/" class="md-nav__link">
        diff
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/enum/" class="md-nav__link">
        enum
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/hashsums/" class="md-nav__link">
        hashsums
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/models/" class="md-nav__link">
        models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/pytest/" class="md-nav__link">
        pytest
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../util/typing/" class="md-nav__link">
        typing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_1_10" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../widget/">widget</a>
          
            <label for="__nav_2_3_1_10">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_3_1_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3_1_10">
          <span class="md-nav__icon md-icon"></span>
          widget
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../widget/common/" class="md-nav__link">
        common
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../widget/dashboard/" class="md-nav__link">
        dashboard
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_1_10_3" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../widget/jupyter/">jupyter</a>
          
            <label for="__nav_2_3_1_10_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_2_3_1_10_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3_1_10_3">
          <span class="md-nav__icon md-icon"></span>
          jupyter
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../widget/jupyter/standalone/" class="md-nav__link">
        standalone
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../widget/server/" class="md-nav__link">
        server
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Development
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/" class="md-nav__link">
        How To Contribute
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev_guide/" class="md-nav__link">
        Developer Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../code_of_conduct/" class="md-nav__link">
        Code of Conduct
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../coverage/" class="md-nav__link">
        Coverage Report
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#metador_core.packer" class="md-nav__link">
    metador_core.packer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metador_core.packer.Packer" class="md-nav__link">
    Packer
  </a>
  
    <nav class="md-nav" aria-label="Packer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metador_core.packer.Packer.check_dir" class="md-nav__link">
    check_dir()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metador_core.packer.Packer.update" class="md-nav__link">
    update()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metador_core.packer.Packer.pack" class="md-nav__link">
    pack()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metador_core.packer.PackerInfo" class="md-nav__link">
    PackerInfo
  </a>
  
    <nav class="md-nav" aria-label="PackerInfo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metador_core.packer.PackerInfo.packer" class="md-nav__link">
    packer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metador_core.packer.PackerInfo.pkg" class="md-nav__link">
    pkg
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metador_core.packer.PackerInfo.source_dir" class="md-nav__link">
    source_dir
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metador_core.packer.Unclosable" class="md-nav__link">
    Unclosable
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metador_core.packer.PGPacker" class="md-nav__link">
    PGPacker
  </a>
  
    <nav class="md-nav" aria-label="PGPacker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metador_core.packer.PGPacker.pack" class="md-nav__link">
    pack()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metador_core.packer.PGPacker.update" class="md-nav__link">
    update()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/Materials-Data-Science-and-Informatics/metador-core/blob/main/docs/src/metador_core/packer/__init__.py" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/Materials-Data-Science-and-Informatics/metador-core/raw/main/docs/src/metador_core/packer/__init__.py" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


  <h1>packer</h1>

<div class="doc doc-object doc-module">


<a id="metador_core.packer"></a>
  <div class="doc doc-contents first">
  
      <p>Definition of HDF5 packer plugin interface.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="metador_core.packer.Packer" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Packer</span>


<a href="#metador_core.packer.Packer" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="abc.ABC">ABC</span></code>, <code><span title="overrides.EnforceOverrides">EnforceOverrides</span></code></p>

  
      <p>Interface to be implemented by Metador HDF5 packer plugins.</p>
<p>These plugins is how support for wildly different domain-specific
use-cases can be added to Metador in a opt-in and loosely-coupled way.</p>
<p>Users can install only the packer plugins they need for their use-cases,
and such plugins can be easily developed independently from the rest
of the Metador tooling, as long as this interface is respected.</p>
<p>Carefully read the documentation for the required attributes and methods
and implement them for your use-case in a subclass.
See <code>metador_core.packer.example.GenericPacker</code> for an example plugin.</p>
<p>Requirements for well-behaved packers:</p>
<ol>
<li>
<p>No closing of the container:
The packer gets a writable record and is only responsible for performing
the neccessary additions, deletions and modifications. It is not allowed
to <code>close()</code> the container.</p>
</li>
<li>
<p>No access to data in the container:
Data in the container MUST NOT be read or be relied on for doing an update,
as the nodes could be dummy stubs. One MAY rely on existence or absence of
Groups, Datasets, Attributes and Metadata in the container (e.g. <code>in</code> or <code>keys</code>).</p>
</li>
<li>
<p>Source directory is read-only:
Files or directories inside of <code>data_dir</code> MUST NOT be created, deleted or
modified by this method.</p>
</li>
<li>
<p>Exceptional termination:
In case that packing must be aborted, and exception MUST be raised.
If the exception happened due to invalid data or metadata, it MUST be
an DirValidationError object like in the other methods above, helping to find
and fix the problem. Otherwise, a different appropriate exception may be used.</p>
</li>
<li>
<p>Semantic correctness:
Packing a directory into a fresh container and updating an existing container
MUST lead to the same observable result.</p>
</li>
</ol>
<p>If you cannot guarantee this in full generality, do not implement <code>update</code>.
In that case, if a container is updated, it will be cleared and then <code>pack</code> is
called on it, as if it was a fresh container. In this case, there is no space
advantage gained over a fresh container (but it will keep its UUID).</p>
<ol>
<li>Semantic versioning of packers:</li>
</ol>
<p>A packer MUST be able to update records that were created by this packer
of the same or an earlier MINOR version.</p>
<p>More formally, the version MAJOR.MINOR.PATCH
MUST adhere to the following contract:</p>
<ol>
<li>
<p>increasing MAJOR means a break in backward-compatibility
for older datasets (i.e. new packer cannot work with old records),</p>
</li>
<li>
<p>increasing MINOR means a break in forward-compatibility
for newer datasets (i.e. older packers will not work with newer records),</p>
</li>
<li>
<p>increasing PATCH does not affect compatibility
for datasets with the same MAJOR and MINOR version.</p>
</li>
</ol>
<p>When the packer is updated, the Python package version MUST increase
in a suitable way. As usual, whenever an earlier number is increased,
the following numbers are reset to zero.</p>
<p>This means, the PATCH version should increase for e.g. bugfixes that do
not change the structure or metadata stored in the dataset,
MINOR should increase whenever from now on older versions of the packer
would not be able to produce a valid update for a dataset created with this version,
but upgrading older existing datasets with this version still works.
Finally, MAJOR version is increased when all compatibility guarantees are off
and the resulting container cannot be migrated or updated automatically.</p>
<p>You SHOULD provide tooling to migrate datasets between major versions.</p>

            <details class="quote">
              <summary>Source code in <code>src/metador_core/packer/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Packer</span><span class="p">(</span><span class="n">ABC</span><span class="p">,</span> <span class="n">EnforceOverrides</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Interface to be implemented by Metador HDF5 packer plugins.</span>

<span class="sd">    These plugins is how support for wildly different domain-specific</span>
<span class="sd">    use-cases can be added to Metador in a opt-in and loosely-coupled way.</span>

<span class="sd">    Users can install only the packer plugins they need for their use-cases,</span>
<span class="sd">    and such plugins can be easily developed independently from the rest</span>
<span class="sd">    of the Metador tooling, as long as this interface is respected.</span>

<span class="sd">    Carefully read the documentation for the required attributes and methods</span>
<span class="sd">    and implement them for your use-case in a subclass.</span>
<span class="sd">    See `metador_core.packer.example.GenericPacker` for an example plugin.</span>

<span class="sd">    Requirements for well-behaved packers:</span>

<span class="sd">    1. No closing of the container:</span>
<span class="sd">    The packer gets a writable record and is only responsible for performing</span>
<span class="sd">    the neccessary additions, deletions and modifications. It is not allowed</span>
<span class="sd">    to `close()` the container.</span>

<span class="sd">    2. No access to data in the container:</span>
<span class="sd">    Data in the container MUST NOT be read or be relied on for doing an update,</span>
<span class="sd">    as the nodes could be dummy stubs. One MAY rely on existence or absence of</span>
<span class="sd">    Groups, Datasets, Attributes and Metadata in the container (e.g. `in` or `keys`).</span>

<span class="sd">    3. Source directory is read-only:</span>
<span class="sd">    Files or directories inside of `data_dir` MUST NOT be created, deleted or</span>
<span class="sd">    modified by this method.</span>

<span class="sd">    4. Exceptional termination:</span>
<span class="sd">    In case that packing must be aborted, and exception MUST be raised.</span>
<span class="sd">    If the exception happened due to invalid data or metadata, it MUST be</span>
<span class="sd">    an DirValidationError object like in the other methods above, helping to find</span>
<span class="sd">    and fix the problem. Otherwise, a different appropriate exception may be used.</span>

<span class="sd">    5. Semantic correctness:</span>
<span class="sd">    Packing a directory into a fresh container and updating an existing container</span>
<span class="sd">    MUST lead to the same observable result.</span>

<span class="sd">    If you cannot guarantee this in full generality, do not implement `update`.</span>
<span class="sd">    In that case, if a container is updated, it will be cleared and then `pack` is</span>
<span class="sd">    called on it, as if it was a fresh container. In this case, there is no space</span>
<span class="sd">    advantage gained over a fresh container (but it will keep its UUID).</span>

<span class="sd">    6. Semantic versioning of packers:</span>

<span class="sd">    A packer MUST be able to update records that were created by this packer</span>
<span class="sd">    of the same or an earlier MINOR version.</span>

<span class="sd">    More formally, the version MAJOR.MINOR.PATCH</span>
<span class="sd">    MUST adhere to the following contract:</span>

<span class="sd">    1. increasing MAJOR means a break in backward-compatibility</span>
<span class="sd">    for older datasets (i.e. new packer cannot work with old records),</span>

<span class="sd">    2. increasing MINOR means a break in forward-compatibility</span>
<span class="sd">    for newer datasets (i.e. older packers will not work with newer records),</span>

<span class="sd">    3. increasing PATCH does not affect compatibility</span>
<span class="sd">    for datasets with the same MAJOR and MINOR version.</span>

<span class="sd">    When the packer is updated, the Python package version MUST increase</span>
<span class="sd">    in a suitable way. As usual, whenever an earlier number is increased,</span>
<span class="sd">    the following numbers are reset to zero.</span>

<span class="sd">    This means, the PATCH version should increase for e.g. bugfixes that do</span>
<span class="sd">    not change the structure or metadata stored in the dataset,</span>
<span class="sd">    MINOR should increase whenever from now on older versions of the packer</span>
<span class="sd">    would not be able to produce a valid update for a dataset created with this version,</span>
<span class="sd">    but upgrading older existing datasets with this version still works.</span>
<span class="sd">    Finally, MAJOR version is increased when all compatibility guarantees are off</span>
<span class="sd">    and the resulting container cannot be migrated or updated automatically.</span>

<span class="sd">    You SHOULD provide tooling to migrate datasets between major versions.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Plugin</span><span class="p">:</span> <span class="n">PackerPlugin</span>

    <span class="nd">@classmethod</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">check_dir</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DirValidationErrors</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check whether the given directory is suitable for packing with this plugin.</span>

<span class="sd">        This method will be called before `pack` or `update` and MUST detect</span>
<span class="sd">        all problems (such as missing or invalid data or metadata) that can be</span>
<span class="sd">        expected to be fixed by the user in preparation for the packing.</span>

<span class="sd">        More specifically, it MUST cover all metadata that is to be provided directly by</span>
<span class="sd">        the user (i.e. is not inferred or extracted from generated data) for the purpose</span>
<span class="sd">        of packing and SHOULD try to cover as many problems with data and metadata as</span>
<span class="sd">        possible to avoid failure during the actual packing process.</span>

<span class="sd">        Files or directories inside of `data_dir` MUST NOT be created,</span>
<span class="sd">        deleted or modified by this method.</span>

<span class="sd">        Args:</span>
<span class="sd">            data_dir: Directory containing all the data to be packed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DirValidationError initialized with a dict mapping file paths</span>
<span class="sd">            (relative to `dir`) to lists of detected errors.</span>

<span class="sd">            The errors must be either a string (containing a human-readable summary of all</span>
<span class="sd">            problems with that file), or another dict with more granular error messages,</span>
<span class="sd">            in case that the file is e.g. a JSON-compatible file subject to validation</span>
<span class="sd">            with JSON Schemas.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@classmethod</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">mc</span><span class="p">:</span> <span class="n">MetadorContainer</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">diff</span><span class="p">:</span> <span class="n">DirDiff</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update a MetadorContainer with changes done to the data source directory.</span>

<span class="sd">        The `container` is assumed to be writable, and is either empty</span>
<span class="sd">        or was previously packed by a compatible version of the packer.</span>

<span class="sd">        The `data_dir` is assumed to be suitable (according to `check_dir`).</span>

<span class="sd">        The `diff` structure contains information about changed paths.</span>

<span class="sd">        If not implemented, updates will be created by clearing the provided</span>
<span class="sd">        container and using `pack` on it.</span>

<span class="sd">        Args:</span>
<span class="sd">            mc: Metador IH5 record to pack the data into or update</span>
<span class="sd">            data_dir: Directory containing all the data to be packed</span>
<span class="sd">            diff: Diff tree of dirs and files in data_dir compared to a previous state</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># default fallback implementation using pack</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="p">[</span><span class="n">mc</span><span class="p">,</span> <span class="n">mc</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span> <span class="n">mc</span><span class="o">.</span><span class="n">meta</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">del</span> <span class="n">obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">pack</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">mc</span><span class="p">:</span> <span class="n">MetadorContainer</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pack a directory into an MetadorContainer.</span>

<span class="sd">        The `container` is assumed to be writable and empty.</span>

<span class="sd">        The `data_dir` is assumed to be suitable (according to `check_dir`).</span>

<span class="sd">        If not implemented, initial packing is done using `update`</span>
<span class="sd">        with an empty container and a diff containing all the files.</span>

<span class="sd">        Args:</span>
<span class="sd">            mc: Metador IH5 record to pack the data into or update</span>
<span class="sd">            data_dir: Directory containing all the data to be packed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># default fallback implementation using update</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">,</span> <span class="n">DirDiff</span><span class="o">.</span><span class="n">compare</span><span class="p">({},</span> <span class="n">dir_hashsums</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="metador_core.packer.Packer.check_dir" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">check_dir</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#metador_core.packer.Packer.check_dir" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">check_dir</span><span class="p">(</span><span class="n">data_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DirValidationErrors</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Check whether the given directory is suitable for packing with this plugin.</p>
<p>This method will be called before <code>pack</code> or <code>update</code> and MUST detect
all problems (such as missing or invalid data or metadata) that can be
expected to be fixed by the user in preparation for the packing.</p>
<p>More specifically, it MUST cover all metadata that is to be provided directly by
the user (i.e. is not inferred or extracted from generated data) for the purpose
of packing and SHOULD try to cover as many problems with data and metadata as
possible to avoid failure during the actual packing process.</p>
<p>Files or directories inside of <code>data_dir</code> MUST NOT be created,
deleted or modified by this method.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data_dir</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Directory containing all the data to be packed.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="metador_core.packer.types.DirValidationErrors" href="types/#metador_core.packer.types.DirValidationErrors">DirValidationErrors</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>DirValidationError initialized with a dict mapping file paths</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="metador_core.packer.types.DirValidationErrors" href="types/#metador_core.packer.types.DirValidationErrors">DirValidationErrors</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(relative to <code>dir</code>) to lists of detected errors.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="metador_core.packer.types.DirValidationErrors" href="types/#metador_core.packer.types.DirValidationErrors">DirValidationErrors</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The errors must be either a string (containing a human-readable summary of all</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="metador_core.packer.types.DirValidationErrors" href="types/#metador_core.packer.types.DirValidationErrors">DirValidationErrors</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>problems with that file), or another dict with more granular error messages,</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="metador_core.packer.types.DirValidationErrors" href="types/#metador_core.packer.types.DirValidationErrors">DirValidationErrors</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>in case that the file is e.g. a JSON-compatible file subject to validation</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="metador_core.packer.types.DirValidationErrors" href="types/#metador_core.packer.types.DirValidationErrors">DirValidationErrors</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>with JSON Schemas.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/metador_core/packer/__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">check_dir</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DirValidationErrors</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check whether the given directory is suitable for packing with this plugin.</span>

<span class="sd">    This method will be called before `pack` or `update` and MUST detect</span>
<span class="sd">    all problems (such as missing or invalid data or metadata) that can be</span>
<span class="sd">    expected to be fixed by the user in preparation for the packing.</span>

<span class="sd">    More specifically, it MUST cover all metadata that is to be provided directly by</span>
<span class="sd">    the user (i.e. is not inferred or extracted from generated data) for the purpose</span>
<span class="sd">    of packing and SHOULD try to cover as many problems with data and metadata as</span>
<span class="sd">    possible to avoid failure during the actual packing process.</span>

<span class="sd">    Files or directories inside of `data_dir` MUST NOT be created,</span>
<span class="sd">    deleted or modified by this method.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_dir: Directory containing all the data to be packed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        DirValidationError initialized with a dict mapping file paths</span>
<span class="sd">        (relative to `dir`) to lists of detected errors.</span>

<span class="sd">        The errors must be either a string (containing a human-readable summary of all</span>
<span class="sd">        problems with that file), or another dict with more granular error messages,</span>
<span class="sd">        in case that the file is e.g. a JSON-compatible file subject to validation</span>
<span class="sd">        with JSON Schemas.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="metador_core.packer.Packer.update" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">update</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#metador_core.packer.Packer.update" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">update</span><span class="p">(</span><span class="n">mc</span><span class="p">:</span> <span class="n">MetadorContainer</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">diff</span><span class="p">:</span> <span class="n">DirDiff</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Update a MetadorContainer with changes done to the data source directory.</p>
<p>The <code>container</code> is assumed to be writable, and is either empty
or was previously packed by a compatible version of the packer.</p>
<p>The <code>data_dir</code> is assumed to be suitable (according to <code>check_dir</code>).</p>
<p>The <code>diff</code> structure contains information about changed paths.</p>
<p>If not implemented, updates will be created by clearing the provided
container and using <code>pack</code> on it.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mc</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="metador_core.container.MetadorContainer" href="../container/#metador_core.container.MetadorContainer">MetadorContainer</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Metador IH5 record to pack the data into or update</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>data_dir</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Directory containing all the data to be packed</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>diff</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="metador_core.util.diff.DirDiff" href="../util/diff/#metador_core.util.diff.DirDiff">DirDiff</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Diff tree of dirs and files in data_dir compared to a previous state</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/metador_core/packer/__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">mc</span><span class="p">:</span> <span class="n">MetadorContainer</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">diff</span><span class="p">:</span> <span class="n">DirDiff</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update a MetadorContainer with changes done to the data source directory.</span>

<span class="sd">    The `container` is assumed to be writable, and is either empty</span>
<span class="sd">    or was previously packed by a compatible version of the packer.</span>

<span class="sd">    The `data_dir` is assumed to be suitable (according to `check_dir`).</span>

<span class="sd">    The `diff` structure contains information about changed paths.</span>

<span class="sd">    If not implemented, updates will be created by clearing the provided</span>
<span class="sd">    container and using `pack` on it.</span>

<span class="sd">    Args:</span>
<span class="sd">        mc: Metador IH5 record to pack the data into or update</span>
<span class="sd">        data_dir: Directory containing all the data to be packed</span>
<span class="sd">        diff: Diff tree of dirs and files in data_dir compared to a previous state</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># default fallback implementation using pack</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="p">[</span><span class="n">mc</span><span class="p">,</span> <span class="n">mc</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span> <span class="n">mc</span><span class="o">.</span><span class="n">meta</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">del</span> <span class="n">obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="metador_core.packer.Packer.pack" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">pack</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#metador_core.packer.Packer.pack" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">pack</span><span class="p">(</span><span class="n">mc</span><span class="p">:</span> <span class="n">MetadorContainer</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Pack a directory into an MetadorContainer.</p>
<p>The <code>container</code> is assumed to be writable and empty.</p>
<p>The <code>data_dir</code> is assumed to be suitable (according to <code>check_dir</code>).</p>
<p>If not implemented, initial packing is done using <code>update</code>
with an empty container and a diff containing all the files.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mc</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="metador_core.container.MetadorContainer" href="../container/#metador_core.container.MetadorContainer">MetadorContainer</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Metador IH5 record to pack the data into or update</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>data_dir</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Directory containing all the data to be packed</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/metador_core/packer/__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">pack</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">mc</span><span class="p">:</span> <span class="n">MetadorContainer</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pack a directory into an MetadorContainer.</span>

<span class="sd">    The `container` is assumed to be writable and empty.</span>

<span class="sd">    The `data_dir` is assumed to be suitable (according to `check_dir`).</span>

<span class="sd">    If not implemented, initial packing is done using `update`</span>
<span class="sd">    with an empty container and a diff containing all the files.</span>

<span class="sd">    Args:</span>
<span class="sd">        mc: Metador IH5 record to pack the data into or update</span>
<span class="sd">        data_dir: Directory containing all the data to be packed</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># default fallback implementation using update</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">,</span> <span class="n">DirDiff</span><span class="o">.</span><span class="n">compare</span><span class="p">({},</span> <span class="n">dir_hashsums</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="metador_core.packer.PackerInfo" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">PackerInfo</span>


<a href="#metador_core.packer.PackerInfo" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="metador_core.schema.core.MetadataSchema" href="../schema/core/#metador_core.schema.core.MetadataSchema">MetadataSchema</a></code></p>

  
      <p>Schema for info about the packer that was used to create a container.</p>

            <details class="quote">
              <summary>Source code in <code>src/metador_core/packer/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PackerInfo</span><span class="p">(</span><span class="n">MetadataSchema</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Schema for info about the packer that was used to create a container.&quot;&quot;&quot;</span>

    <span class="k">class</span> <span class="nc">Plugin</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;core.packerinfo&quot;</span>
        <span class="n">version</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">packer</span><span class="p">:</span> <span class="n">PGPacker</span><span class="o">.</span><span class="n">PluginRef</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Packer plugin used to pack the container.&quot;&quot;&quot;</span>

    <span class="n">pkg</span><span class="p">:</span> <span class="n">PluginPkgMeta</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Python package that provides the packer plugin.&quot;&quot;&quot;</span>

    <span class="n">source_dir</span><span class="p">:</span> <span class="n">DirHashsums</span> <span class="o">=</span> <span class="p">{}</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Directory skeleton with hashsums of files at the time of packing.&quot;&quot;&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">for_packer</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">packer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">packer_version</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PackerInfo</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">..plugins</span> <span class="kn">import</span> <span class="n">packers</span>

        <span class="n">p_ref</span> <span class="o">=</span> <span class="n">packers</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">packer_name</span><span class="p">,</span> <span class="n">packer_version</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">PackerInfo</span><span class="p">(</span>
            <span class="n">packer</span><span class="o">=</span><span class="n">p_ref</span><span class="p">,</span>
            <span class="n">pkg</span><span class="o">=</span><span class="n">packers</span><span class="o">.</span><span class="n">provider</span><span class="p">(</span><span class="n">p_ref</span><span class="p">),</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="metador_core.packer.PackerInfo.packer" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">packer</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#metador_core.packer.PackerInfo.packer" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">packer</span><span class="p">:</span> <span class="n">PGPacker</span><span class="o">.</span><span class="n">PluginRef</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Packer plugin used to pack the container.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="metador_core.packer.PackerInfo.pkg" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">pkg</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#metador_core.packer.PackerInfo.pkg" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">pkg</span><span class="p">:</span> <span class="n">PluginPkgMeta</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Python package that provides the packer plugin.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="metador_core.packer.PackerInfo.source_dir" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">source_dir</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#metador_core.packer.PackerInfo.source_dir" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">source_dir</span><span class="p">:</span> <span class="n">DirHashsums</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Directory skeleton with hashsums of files at the time of packing.</p>
  </div>

</div>





  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="metador_core.packer.Unclosable" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Unclosable</span>


<a href="#metador_core.packer.Unclosable" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>wrapt.<span title="wrapt.ObjectProxy">ObjectProxy</span></code></p>

  
      <p>Wrapper to prevent packers from closing/completing a container file.</p>

            <details class="quote">
              <summary>Source code in <code>src/metador_core/packer/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Unclosable</span><span class="p">(</span><span class="n">wrapt</span><span class="o">.</span><span class="n">ObjectProxy</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrapper to prevent packers from closing/completing a container file.&quot;&quot;&quot;</span>

    <span class="n">_self_MSG</span> <span class="o">=</span> <span class="s2">&quot;Packers must not finalize the container!&quot;</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">UnsupportedOperation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_self_MSG</span><span class="p">)</span>

    <span class="c1"># specific for IH5Record subtypes:</span>

    <span class="k">def</span> <span class="nf">discard_patch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">UnsupportedOperation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_self_MSG</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">commit_patch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">UnsupportedOperation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_self_MSG</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="metador_core.packer.PGPacker" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">PGPacker</span>


<a href="#metador_core.packer.PGPacker" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="metador_core.plugin.interface" href="../plugin/interface/#metador_core.plugin.interface">pg</a>.<a class="autorefs autorefs-internal" title="metador_core.plugin.interface.PluginGroup" href="../plugin/interface/#metador_core.plugin.interface.PluginGroup">PluginGroup</a>[<a class="autorefs autorefs-internal" title="metador_core.packer.Packer" href="#metador_core.packer.Packer">Packer</a>]</code></p>

  
      <p>Packer plugin group interface.</p>

            <details class="quote">
              <summary>Source code in <code>src/metador_core/packer/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PGPacker</span><span class="p">(</span><span class="n">pg</span><span class="o">.</span><span class="n">PluginGroup</span><span class="p">[</span><span class="n">Packer</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Packer plugin group interface.&quot;&quot;&quot;</span>

    <span class="k">class</span> <span class="nc">Plugin</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">PACKER_GROUP_NAME</span>
        <span class="n">version</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">plugin_class</span> <span class="o">=</span> <span class="n">Packer</span>
        <span class="n">plugin_info_class</span> <span class="o">=</span> <span class="n">PackerPlugin</span>
        <span class="n">requires</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">plugingroups</span><span class="o">.</span><span class="n">PluginRef</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;schema&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
            <span class="n">plugingroups</span><span class="o">.</span><span class="n">PluginRef</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;harvester&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
        <span class="p">]</span>

    <span class="n">_PACKER_INFO_NAME</span> <span class="o">=</span> <span class="n">PackerInfo</span><span class="o">.</span><span class="n">Plugin</span><span class="o">.</span><span class="n">name</span>

    <span class="nd">@overrides</span>
    <span class="k">def</span> <span class="nf">check_plugin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ep_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">plugin</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">Packer</span><span class="p">]):</span>
        <span class="n">pg</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">check_implements_method</span><span class="p">(</span><span class="n">ep_name</span><span class="p">,</span> <span class="n">plugin</span><span class="p">,</span> <span class="n">Packer</span><span class="o">.</span><span class="n">check_dir</span><span class="p">)</span>
        <span class="n">missing_pack</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">implements_method</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">Packer</span><span class="o">.</span><span class="n">pack</span><span class="p">)</span>
        <span class="n">missing_update</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">implements_method</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">Packer</span><span class="o">.</span><span class="n">update</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">missing_pack</span> <span class="ow">and</span> <span class="n">missing_update</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ep_name</span><span class="si">}</span><span class="s2">: Neither pack nor update are implemented!&quot;</span><span class="p">)</span>

    <span class="c1"># ----</span>

    <span class="k">def</span> <span class="nf">_prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pname</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">srcdir</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">Packer</span><span class="p">],</span> <span class="n">DirHashsums</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return packer class and hashsums of given directory.</span>

<span class="sd">        Raises an exception if packer is not found or `packer.check_dir` fails.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">packer</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">pname</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">errs</span> <span class="o">:=</span> <span class="n">packer</span><span class="o">.</span><span class="n">check_dir</span><span class="p">(</span><span class="n">srcdir</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">errs</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">packer</span><span class="p">,</span> <span class="n">dir_hashsums</span><span class="p">(</span><span class="n">srcdir</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">pack</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">packer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">h5like_cls</span><span class="p">:</span> <span class="n">Callable</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pack a directory into a container using an installed packer.</span>

<span class="sd">        `packer_name` must be an installed packer plugin.</span>

<span class="sd">        `data_dir` must be an existing directory suitable for the packer.</span>

<span class="sd">        `target` must be a non-existing path and will be passed into `h5like_cls` as-is.</span>

<span class="sd">        `h5like_cls` must be a class compatible with MetadorContainer.</span>

<span class="sd">        In case an exception happens during packing, notice that no cleanup is done.</span>

<span class="sd">        The user is responsible for removing inconsistent files that were created.</span>

<span class="sd">        Args:</span>
<span class="sd">            packer_name: installed packer plugin name</span>
<span class="sd">            data_dir: data source directory</span>
<span class="sd">            target: target path for resulting container</span>
<span class="sd">            h5like_cls: class to use for creating the container</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">packer</span><span class="p">,</span> <span class="n">hashsums</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare</span><span class="p">(</span><span class="n">packer_name</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
        <span class="c1"># use skel_only to enforce stub-compatibility of packer</span>
        <span class="n">container</span> <span class="o">=</span> <span class="n">MetadorContainer</span><span class="p">(</span><span class="n">h5like_cls</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">skel_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">packer</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">Unclosable</span><span class="p">(</span><span class="n">container</span><span class="p">),</span> <span class="n">data_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_finalize</span><span class="p">(</span><span class="n">packer_name</span><span class="p">,</span> <span class="n">hashsums</span><span class="p">,</span> <span class="n">container</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">packer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">h5like_cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update a container from its source directory using an installed packer.</span>

<span class="sd">        Like `pack`, but the `target` must be a container which can be opened</span>
<span class="sd">        with the `h5like_cls` and was packed by a compatible packer.</span>

<span class="sd">        In case an exception happens during packing, notice that no cleanup is done</span>
<span class="sd">        and if the container has been written to, the changes persist.</span>

<span class="sd">        The user is responsible for removing inconsistent files that were created</span>
<span class="sd">        and ensuring that the previous state can be restored, e.g. from a backup.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">packer</span><span class="p">,</span> <span class="n">hashsums</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare</span><span class="p">(</span><span class="n">packer_name</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
        <span class="c1"># use skel_only to enforce stub-compatibility of packer</span>
        <span class="n">container</span> <span class="o">=</span> <span class="n">MetadorContainer</span><span class="p">(</span><span class="n">h5like_cls</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s2">&quot;r+&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">skel_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># check compatibility</span>
        <span class="n">pinfo</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_PACKER_INFO_NAME</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pinfo</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Container does not have </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_PACKER_INFO_NAME</span><span class="si">}</span><span class="s2"> metadata!&quot;</span>
        <span class="n">curr_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">packer_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">curr_ref</span><span class="o">.</span><span class="n">supports</span><span class="p">(</span><span class="n">pinfo</span><span class="o">.</span><span class="n">packer</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">curr_ref</span><span class="si">}</span><span class="s2"> (installed) does not support </span><span class="si">{</span><span class="n">pinfo</span><span class="o">.</span><span class="n">packer</span><span class="si">}</span><span class="s2"> (container)!&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="n">diff</span> <span class="o">=</span> <span class="n">DirDiff</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">pinfo</span><span class="o">.</span><span class="n">source_dir</span><span class="p">,</span> <span class="n">hashsums</span><span class="p">)</span>
        <span class="n">packer</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">Unclosable</span><span class="p">(</span><span class="n">container</span><span class="p">),</span> <span class="n">data_dir</span><span class="p">,</span> <span class="n">diff</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_finalize</span><span class="p">(</span><span class="n">packer_name</span><span class="p">,</span> <span class="n">hashsums</span><span class="p">,</span> <span class="n">container</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pname</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">hsums</span><span class="p">:</span> <span class="n">DirHashsums</span><span class="p">,</span> <span class="n">cont</span><span class="p">:</span> <span class="n">MetadorContainer</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set or update packer info in container and close it.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PACKER_INFO_NAME</span> <span class="ow">in</span> <span class="n">cont</span><span class="o">.</span><span class="n">meta</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">cont</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_PACKER_INFO_NAME</span><span class="p">]</span>

        <span class="n">pinfo</span> <span class="o">=</span> <span class="n">PackerInfo</span><span class="o">.</span><span class="n">for_packer</span><span class="p">(</span><span class="n">pname</span><span class="p">)</span>
        <span class="n">pinfo</span><span class="o">.</span><span class="n">source_dir</span> <span class="o">=</span> <span class="n">hsums</span>
        <span class="n">cont</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_PACKER_INFO_NAME</span><span class="p">]</span> <span class="o">=</span> <span class="n">pinfo</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">IH5MFRecord</span><span class="p">):</span>
            <span class="c1"># when using IH5MFRecord,</span>
            <span class="c1"># we want the packerinfo in the manifest, so tooling can decide</span>
            <span class="c1"># if a container can be updated without having it available.</span>
            <span class="c1"># (default manifest already has enough info for creating stubs)</span>
            <span class="n">cont</span><span class="o">.</span><span class="n">manifest</span><span class="o">.</span><span class="n">manifest_exts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pinfo</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>

        <span class="n">cont</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="metador_core.packer.PGPacker.pack" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">pack</span>


<a href="#metador_core.packer.PGPacker.pack" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">pack</span><span class="p">(</span>
    <span class="n">packer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">data_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">h5like_cls</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Pack a directory into a container using an installed packer.</p>
<p><code>packer_name</code> must be an installed packer plugin.</p>
<p><code>data_dir</code> must be an existing directory suitable for the packer.</p>
<p><code>target</code> must be a non-existing path and will be passed into <code>h5like_cls</code> as-is.</p>
<p><code>h5like_cls</code> must be a class compatible with MetadorContainer.</p>
<p>In case an exception happens during packing, notice that no cleanup is done.</p>
<p>The user is responsible for removing inconsistent files that were created.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>packer_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>installed packer plugin name</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>data_dir</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>data source directory</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>target</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>target path for resulting container</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>h5like_cls</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>class to use for creating the container</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/metador_core/packer/__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">pack</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">packer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">h5like_cls</span><span class="p">:</span> <span class="n">Callable</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pack a directory into a container using an installed packer.</span>

<span class="sd">    `packer_name` must be an installed packer plugin.</span>

<span class="sd">    `data_dir` must be an existing directory suitable for the packer.</span>

<span class="sd">    `target` must be a non-existing path and will be passed into `h5like_cls` as-is.</span>

<span class="sd">    `h5like_cls` must be a class compatible with MetadorContainer.</span>

<span class="sd">    In case an exception happens during packing, notice that no cleanup is done.</span>

<span class="sd">    The user is responsible for removing inconsistent files that were created.</span>

<span class="sd">    Args:</span>
<span class="sd">        packer_name: installed packer plugin name</span>
<span class="sd">        data_dir: data source directory</span>
<span class="sd">        target: target path for resulting container</span>
<span class="sd">        h5like_cls: class to use for creating the container</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">packer</span><span class="p">,</span> <span class="n">hashsums</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare</span><span class="p">(</span><span class="n">packer_name</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
    <span class="c1"># use skel_only to enforce stub-compatibility of packer</span>
    <span class="n">container</span> <span class="o">=</span> <span class="n">MetadorContainer</span><span class="p">(</span><span class="n">h5like_cls</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">skel_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">packer</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">Unclosable</span><span class="p">(</span><span class="n">container</span><span class="p">),</span> <span class="n">data_dir</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_finalize</span><span class="p">(</span><span class="n">packer_name</span><span class="p">,</span> <span class="n">hashsums</span><span class="p">,</span> <span class="n">container</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="metador_core.packer.PGPacker.update" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">update</span>


<a href="#metador_core.packer.PGPacker.update" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">update</span><span class="p">(</span>
    <span class="n">packer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">data_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">h5like_cls</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Update a container from its source directory using an installed packer.</p>
<p>Like <code>pack</code>, but the <code>target</code> must be a container which can be opened
with the <code>h5like_cls</code> and was packed by a compatible packer.</p>
<p>In case an exception happens during packing, notice that no cleanup is done
and if the container has been written to, the changes persist.</p>
<p>The user is responsible for removing inconsistent files that were created
and ensuring that the previous state can be restored, e.g. from a backup.</p>

          <details class="quote">
            <summary>Source code in <code>src/metador_core/packer/__init__.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">packer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">h5like_cls</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update a container from its source directory using an installed packer.</span>

<span class="sd">    Like `pack`, but the `target` must be a container which can be opened</span>
<span class="sd">    with the `h5like_cls` and was packed by a compatible packer.</span>

<span class="sd">    In case an exception happens during packing, notice that no cleanup is done</span>
<span class="sd">    and if the container has been written to, the changes persist.</span>

<span class="sd">    The user is responsible for removing inconsistent files that were created</span>
<span class="sd">    and ensuring that the previous state can be restored, e.g. from a backup.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">packer</span><span class="p">,</span> <span class="n">hashsums</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare</span><span class="p">(</span><span class="n">packer_name</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
    <span class="c1"># use skel_only to enforce stub-compatibility of packer</span>
    <span class="n">container</span> <span class="o">=</span> <span class="n">MetadorContainer</span><span class="p">(</span><span class="n">h5like_cls</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s2">&quot;r+&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">skel_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># check compatibility</span>
    <span class="n">pinfo</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_PACKER_INFO_NAME</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pinfo</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Container does not have </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_PACKER_INFO_NAME</span><span class="si">}</span><span class="s2"> metadata!&quot;</span>
    <span class="n">curr_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">packer_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">curr_ref</span><span class="o">.</span><span class="n">supports</span><span class="p">(</span><span class="n">pinfo</span><span class="o">.</span><span class="n">packer</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">curr_ref</span><span class="si">}</span><span class="s2"> (installed) does not support </span><span class="si">{</span><span class="n">pinfo</span><span class="o">.</span><span class="n">packer</span><span class="si">}</span><span class="s2"> (container)!&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="n">diff</span> <span class="o">=</span> <span class="n">DirDiff</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">pinfo</span><span class="o">.</span><span class="n">source_dir</span><span class="p">,</span> <span class="n">hashsums</span><span class="p">)</span>
    <span class="n">packer</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">Unclosable</span><span class="p">(</span><span class="n">container</span><span class="p">),</span> <span class="n">data_dir</span><span class="p">,</span> <span class="n">diff</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_finalize</span><span class="p">(</span><span class="n">packer_name</span><span class="p">,</span> <span class="n">hashsums</span><span class="p">,</span> <span class="n">container</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../ih5/skeleton/" class="md-footer__link md-footer__link--prev" aria-label="Previous: skeleton" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                skeleton
              </div>
            </div>
          </a>
        
        
          
          <a href="example/" class="md-footer__link md-footer__link--next" aria-label="Next: example" rel="next">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                example
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <!-- Copyright and theme information -->
<div class="md-copyright">
  
  
    Made with
    <a
      href="https://squidfunk.github.io/mkdocs-material/"
      target="_blank" rel="noopener"
    >
      Material for MkDocs
    </a>
    <!-- added link to project template -->
    and
    <a
      href="https://github.com/Materials-Data-Science-and-Informatics/fair-python-cookiecutter"
      target="_blank" rel="noopener"
    >
      fair-python-cookiecutter
    </a>
    <!-- ------------------------------ -->
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Materials-Data-Science-and-Informatics" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/Materials-Data-Science-and-Informatics" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M352 256c0 22.2-1.2 43.6-3.3 64H163.3c-2.2-20.4-3.3-41.8-3.3-64s1.2-43.6 3.3-64h185.4c2.2 20.4 3.3 41.8 3.3 64zm28.8-64h123.1c5.3 20.5 8.1 41.9 8.1 64s-2.8 43.5-8.1 64H380.8c2.1-20.6 3.2-42 3.2-64s-1.1-43.4-3.2-64zm112.6-32H376.7c-10-63.9-29.8-117.4-55.3-151.6 78.3 20.7 142 77.5 171.9 151.6zm-149.1 0H167.7c6.1-36.4 15.5-68.6 27-94.7 10.5-23.6 22.2-40.7 33.5-51.5C239.4 3.2 248.7 0 256 0s16.6 3.2 27.8 13.8c11.3 10.8 23 27.9 33.5 51.5 11.6 26 20.9 58.2 27 94.7zm-209 0H18.6c30-74.1 93.6-130.9 172-151.6-25.5 34.2-45.3 87.7-55.3 151.6zM8.1 192h123.1c-2.1 20.6-3.2 42-3.2 64s1.1 43.4 3.2 64H8.1C2.8 299.5 0 278.1 0 256s2.8-43.5 8.1-64zm186.6 254.6c-11.6-26-20.9-58.2-27-94.6h176.6c-6.1 36.4-15.5 68.6-27 94.6-10.5 23.6-22.2 40.7-33.5 51.5-11.2 10.7-20.5 13.9-27.8 13.9s-16.6-3.2-27.8-13.8c-11.3-10.8-23-27.9-33.5-51.5zM135.3 352c10 63.9 29.8 117.4 55.3 151.6-78.4-20.7-142-77.5-172-151.6h116.7zm358.1 0c-30 74.1-93.6 130.9-171.9 151.6 25.5-34.2 45.2-87.7 55.3-151.6h116.6z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.action.edit", "content.action.view", "content.code.annotate", "header.autohide", "navigation.footer", "navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "navigation.top", "search.highlight", "search.suggest"], "search": "../../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>